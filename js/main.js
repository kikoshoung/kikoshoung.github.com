/* v0.2.0, last modified at 2014-06-14 11:04:31 */
var site={siteName:"Kiko's blog",ua:navigator.userAgent,isPC:"ontouchstart"in window?!1:!0,IESupportedVersion:8,events:{},routerMap:{timeline:{fileName:"timeline",titleFragment:" | \u65f6\u95f4\u7ebf"},profile:{fileName:"profile",titleFragment:" | \u7b80\u5386"},"smart-spot":{fileName:"smartspot",titleFragment:" | Smart\u627e\u832c"},"e-name":{fileName:"ename",titleFragment:" | \u8d77\u4e2a\u6d0b\u540d\u513f"},"radar-charts":{fileName:"radarcharts",titleFragment:" | Radarcharts"},"ad-killer":{fileName:"ad-killer",titleFragment:" | \u5e7f\u544a\u6740\u624b-\u63d2\u4ef6"},"scratch-card":{fileName:"scratchcard",titleFragment:" | \u522e\u522e\u5361"}},suguestedBrowsers:[{name:"Chrome",downloadLink:"http://www.google.com/intl/zh-CN/chrome/browser"},{name:"Firefox",downloadLink:"http://firefox.com.cn"},{name:"Safari",downloadLink:"http://www.apple.com.cn/safari"},{name:"Opera",downloadLink:"http://www.opera.com"},{name:"IE9",downloadLink:"http://windows.microsoft.com/zh-cn/internet-explorer/downloads/ie-9/worldwide-languages"}],init:function(e){var t=this;browserSupported=this.checkBrowser(this.IESupportedVersion),t.html5shiv(),t.setEvents(),t.cacheElement(),browserSupported?(t.bindEvents(),window.onhashchange=function(){t.refreshPage()},""==location.hash?location.hash=e:window.onhashchange()):t.showNotSupportedPage()},html5shiv:function(){for(var e=["header","footer","aside","section","nav","menu","article","figure","figcaption","dialog"],t=0,i=e.length;i>t;t++)document.createElement(e[t])},setEvents:function(){var e=this.isPC;this.events={mousedown:e?"mousedown":"touchstart",mousemove:e?"mousemove":"touchmove",mouseup:e?"mouseup":"touchend",click:e?"click":"touchstart"}},cacheElement:function(){this.win=$(window),this.body=$("body"),this.article=$("#article"),this.loading=$("#loading"),this.header=$("#header"),this.title=$("#title"),this.menuBtn=$("#menu-btn"),this.menuList=$("#menu-list")},bindEvents:function(){var e=this.isPC;e&&this.bindSidebar(),this.bindMenu()},bindSidebar:function(){var e=this.win,t=$("#fix-block"),i=t.offset();e.on("scroll",function(){e.scrollTop()>=i.top?t.addClass("active"):t.removeClass("active")}),e.on("resize",function(){i=t.offset(),t.removeClass("active")})},bindMenu:function(){var e=this.menuBtn,t=this.article,i=(this.header,this);e.on(this.events.click,function(){t.hasClass("active")?i.hideMenuList():i.showMenuList()})},showMenuList:function(){this.header.addClass("active"),this.article.addClass("active"),this.menuList.addClass("active").scrollTop(0)},hideMenuList:function(){this.header.removeClass("active"),this.article.removeClass("active"),this.menuList.removeClass("active")},preventLinkDefault:function(){this.body.delegate("a","click",function(e){var t=$(this).attr("href");e.preventDefault(),location.hash=t})},hashchangeHandler:function(){var e=this.router[location.hash];this.refreshPage(e)},refreshPage:function(e){var e,t,i,s=location.hash,a=this.routerMap,n=this.IESupportedVersion,o=this.article,r=this;switch(s=s.substr(1,s.length),a[s]?(e=a[s].fileName,t=this.siteName+a[s].titleFragment):(e="404",t=this.siteName+" | 404"),document.title=t,this.title.html(t),e){case"smartspot":case"ename":case"radarcharts":n=100;break;case"scratchcard":n=9}if(i=this.checkBrowser(n))this.showLoading(),o.html("\u52a0\u8f7d\u4e2d...").load("/page/"+e+".html",function(){r.hideLoading(),r.hideMenuList()});else{var o=this.article,h=100==n?!1:!0,c=this.getSugguestedList(h);o.html('<h1>\u8be5\u9879\u76ee\u9700\u8981\u4f7f\u7528\u5bf9HTML5\u7279\u6027\u652f\u6301\u8f83\u597d\u7684\u6d4f\u89c8\u5668\u624d\u80fd\u67e5\u770b</h1>								<p class="mt-m mb-s">\u5efa\u8bae\u4f7f\u7528\u4ee5\u4e0b\u6d4f\u89c8\u5668\u67e5\u770b\u8be5\u9879\u76ee\uff1a</p>'),o.append(c)}},showLoading:function(){this.loading.css({right:0,opacity:1})},hideLoading:function(){var e=this.loading.outerWidth();this.loading.animate({right:"-="+e,opacity:0})},checkBrowser:function(e){var t=this.ua.toLowerCase().match(/(chrome|firefox|safari|opera|msie)/gi)[0],i="msie"==t?this.ua.toLowerCase().match(/msie\s*\d+/gi)[0].match(/\d+/):1e3;return IESupportedVersion=e?e:this.IESupportedVersion,t||(t="other"),"msie"==t&&IESupportedVersion>i?!1:!0},showNotSupportedPage:function(){var e=this.body;suguestedList=this.getSugguestedList(!0),e.html('<div style="width: 40%; margin: 100px auto 0 auto; background-color: #EFF5F2;">							<div class="inner p-l">								<h1>\u62b1\u6b49\uff0c\u60a8\u4f7f\u7528\u7684\u6d4f\u89c8\u5668\u7248\u672c\u8fc7\u4f4e</h1>								<p class="mt-m mb-s">\u5efa\u8bae\u4f7f\u7528\u4ee5\u4e0b\u6d4f\u89c8\u5668\u6d4f\u89c8\u672c\u7f51\u7ad9\uff1a</p>							</div>						</div>'),e.find(".inner").append(suguestedList)},getSugguestedList:function(e){var t="<ul>",i=this.suguestedBrowsers;e||(i=i.slice(0,i.length-1));for(var s=0;i.length>s;s++){var a=i[s];t+='<li><a target="_blank" href="'+a.downloadLink+'">'+a.name+"</a></li>"}return t+"</ul>"},codeareaHandler:function(e){e.each(function(){for(var e=$(this),t=$.trim(e.text()),i=t.match(/((.*)\n|\n?(.*)\n?)/g),i=i.slice(0,i.length-1),s=i.length,a='<ul class="code-row-list">',n="",o=1;s>=o;o++)n+='<p><span class="num">'+o+"</span>"+i[o-1]+"</p>";a+="</ul>",n="<code>"+n+"</code>",e.html(n)})}};site.init("timeline");